{{- $items := where (.resources.Match (printf "%s/*.md" .Name)) ".Name" "ne" .self.Name -}}
{{- $self := . -}}

{{ "<!-- Pricing -->" | safeHTML }}
<section id="{{ .Name }}">
  <div class="overlay container-fluid
    {{- partial "helpers/background.html" $self.self -}}
  ">
    {{- $bg := $self.self.Scratch.Get "bg" }}
    <div class="container py-5">
      {{- partial "helpers/section-header.html" (dict "bg" $bg "params" .Params) }}
      {{- with .Content -}}
        <div class="row">
          <div class="col text-center pt-4 pb-5
            {{- partial "helpers/text-color.html" $self.self -}}
          ">
            {{- . -}}
          </div>
        </div>
      {{- end }}
      <div class="row {{- if not .Content -}}{{ print " pt-4" }}{{ end }}">
        {{- if eq (len $items) 0 -}}
          {{- partial "helpers/empty-subpath.html" (dict "context" "pricing" "root" $) -}}
        {{- end -}}
        {{- range (sort $items ".Params.weight") }}
          <div class="col-lg-4 col-md-6 col-12 py-2 pricing-plan {{- if .Params.highlight }} pricing-plan-highlight {{- end -}}">
            <div class="card">
              <div class="card-header
                {{- printf " bg-%s" (.Params.header_bg | default "primary") -}}
                {{- printf " text-%s" (.Params.header_text_color | default "light") -}}">
                <h4 class="mt-0 font-weight-normal text-center">{{ .Title }}</h4>
                <div class="mt-0 h6 font-weight-normal text-center">{{ (.Params.subtitle | default "") | markdownify }}</div>
                <h2 class="card-title mb-0 pricing-card-title text-center">{{ .Params.price }}</h2>
              </div>
              <div class="card-body {{ printf "bg-%s" (.Params.bg | default "light") }}">
                <div class="mb-4 features">
                  {{- range .Params.features }}
                    <p><i class="{{ .icon }}"></i>{{ .text | markdownify }}</p>
                  {{- end }}
                </div>
                <a href="{{ .Params.button_url | relLangURL }}" class="btn btn-lg btn-block btn-primary">{{ .Params.button_text }}</a>
              </div>
            </div>
          </div>
        {{- end }}
      </div>
    </div>
  </div>
</section>
